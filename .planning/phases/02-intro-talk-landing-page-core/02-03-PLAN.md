---
phase: 02-intro-talk-landing-page-core
plan: 03
type: execute
wave: 1
depends_on: ["02-02"]
files_modified:
  - src/components/intro/registration-form.tsx
autonomous: true
gap_closure: true
requirements: [INTRO-01, INTRO-02, INTRO-03, INTRO-04, INTRO-05, INTRO-09]

must_haves:
  truths:
    - "registration-form.tsx imports registrationSchema and uses it for client-side validation via react-hook-form zodResolver"
    - "Form shows inline field-level error messages on blur (before server round-trip) for invalid name, email, and unchecked consent"
    - "A trust indicator (lock icon + 'No spam. Unsubscribe anytime.' text) appears near the registration form below the consent checkbox"
  artifacts:
    - path: "src/components/intro/registration-form.tsx"
      provides: "Client-side Zod validation via react-hook-form + trust indicators near form"
      contains: "registrationSchema"
  key_links:
    - from: "src/components/intro/registration-form.tsx"
      to: "src/lib/schemas/registration.ts"
      via: "imports registrationSchema for zodResolver"
      pattern: "import.*registrationSchema.*from.*@/lib/schemas/registration"
---

<objective>
Close two verification gaps from Phase 02:
1. Wire client-side Zod validation in registration-form.tsx via react-hook-form + zodResolver (missing key link)
2. Add trust indicators near the registration form to fully satisfy INTRO-09

Purpose: Complete Phase 02 verification to 9/9 must-haves. The form currently relies on HTML required attributes and server-side Zod only -- adding client-side validation gives instant inline feedback on blur, improving the mobile UX for Facebook ad traffic. Trust indicators ("No spam. Unsubscribe anytime.") reduce form abandonment anxiety.
Output: Updated registration-form.tsx with both gaps closed.
</objective>

<execution_context>
@/Users/mac/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mac/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-intro-talk-landing-page-core/02-VERIFICATION.md
@.planning/phases/02-intro-talk-landing-page-core/02-02-SUMMARY.md
@src/components/intro/registration-form.tsx
@src/lib/schemas/registration.ts
@src/actions/register.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add client-side Zod validation and trust indicators to registration form</name>
  <files>src/components/intro/registration-form.tsx</files>
  <action>
Update registration-form.tsx to close both verification gaps:

**Gap 1 -- Client-side Zod validation:**
- Import `registrationSchema` and `RegistrationInput` from `@/lib/schemas/registration`
- Import `useForm` from `react-hook-form` and `zodResolver` from `@hookform/resolvers/zod`
- Create a form instance with `useForm<RegistrationInput>({ resolver: zodResolver(registrationSchema), defaultValues: { name: "", email: "", phone: "", consent: false as unknown as true }, mode: "onTouched" })`
- Register each field using `{...form.register("fieldName")}` on the Input components (name, email, phone)
- For the Checkbox, use `form.register("consent")` -- note: shadcn Checkbox uses `onCheckedChange`, so wire it manually: `onCheckedChange={(checked) => form.setValue("consent", checked === true, { shouldValidate: true })}` and `checked={form.watch("consent") as boolean}`
- Display field errors from `form.formState.errors` (e.g. `form.formState.errors.name?.message`) in ADDITION to the existing `state.errors` from the server action -- client errors show first (on blur), server errors show after submission
- Keep the existing `action={formAction}` on the form element and the `useActionState` hook -- the dual approach means client-side validation fires on blur/touch for instant feedback, and server action still validates on submit as a fallback
- Important: The form still submits via `action={formAction}` (not `onSubmit`). react-hook-form is used ONLY for client-side validation display, not for submission handling. The HTML `name` attributes on inputs ensure FormData is populated for the server action.
- Keep all existing `required` HTML attributes on inputs as progressive enhancement

**Gap 2 -- Trust indicators for INTRO-09:**
- Import `Shield` (or `Lock`) icon from `lucide-react`
- Add a trust indicator line BELOW the GDPR consent checkbox div and above the submit button:
  ```tsx
  <div className="flex items-center gap-2 text-xs text-muted-foreground">
    <Lock className="h-3.5 w-3.5 shrink-0" />
    <span>No spam. Unsubscribe anytime. Your data is safe.</span>
  </div>
  ```
- This satisfies the "trust indicators" part of INTRO-09 that was flagged as partial

**Important -- preserve existing behavior:**
- Keep Card wrapper, all existing styling, aria-live server response display
- Keep `useActionState(registerForIntroTalk, initialState)` for server-side submission
- Keep all existing class names and responsive patterns
  </action>
  <verify>
    <automated>cd "/Users/mac/Documents/Art of Living Landing Page" && npx tsc --noEmit && npm run build 2>&1 | tail -5</automated>
    <manual>Open /intro, blur through empty name field -- inline error shows. Check for lock icon + "No spam" text below consent checkbox.</manual>
  </verify>
  <done>
- registration-form.tsx imports registrationSchema from @/lib/schemas/registration (key link wired)
- react-hook-form with zodResolver provides inline field-level errors on blur before server round-trip
- Lock icon + "No spam. Unsubscribe anytime." trust indicator visible near form
- Build passes with zero errors
- Existing server action submission flow unchanged
  </done>
</task>

</tasks>

<verification>
1. `grep -q "registrationSchema" src/components/intro/registration-form.tsx` exits 0 (key link wired)
2. `grep -q "zodResolver" src/components/intro/registration-form.tsx` exits 0 (client-side validation)
3. `grep -q "No spam" src/components/intro/registration-form.tsx` exits 0 (trust indicator)
4. `npm run build` completes with zero errors
</verification>

<success_criteria>
- Phase 02 VERIFICATION gaps both closed: client-side schema validation wired, trust indicators added
- INTRO-09 fully satisfied (GDPR checkbox + privacy link + trust indicators)
- Build passes, no regressions to existing form submission flow
</success_criteria>

<output>
After completion, create `.planning/phases/02-intro-talk-landing-page-core/02-03-SUMMARY.md`
</output>
