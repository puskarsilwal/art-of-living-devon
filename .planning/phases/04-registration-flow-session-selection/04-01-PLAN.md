---
phase: 04-registration-flow-session-selection
plan: "01"
type: execute
wave: 1
depends_on: []
files_modified:
  - src/lib/data/intro-talks.ts
  - src/components/intro/countdown-timer.tsx
  - src/components/intro/hero-section.tsx
autonomous: true
requirements:
  - INTRO-11

must_haves:
  truths:
    - "Hero section displays a live countdown timer showing days/hours/minutes/seconds to the next session"
    - "Timer initializes as null on server and populates only after hydration (no SSR mismatch)"
    - "When countdown reaches zero, timer advances to next available session or shows 'Registration open' fallback"
    - "Session data array provides id, zoomUrl, dateISO, badge fields for downstream plans to use"
  artifacts:
    - path: "src/lib/data/intro-talks.ts"
      provides: "IntroTalkSession type + introTalkSessions array with 3 sessions + nextIntroTalk convenience export"
      contains: "introTalkSessions"
    - path: "src/components/intro/countdown-timer.tsx"
      provides: "Client-side countdown timer component"
      exports: ["CountdownTimer"]
    - path: "src/components/intro/hero-section.tsx"
      provides: "Hero section with embedded countdown timer"
      contains: "CountdownTimer"
  key_links:
    - from: "src/components/intro/countdown-timer.tsx"
      to: "src/lib/data/intro-talks.ts"
      via: "imports introTalkSessions, filters by dateISO > now"
      pattern: "introTalkSessions"
    - from: "src/components/intro/hero-section.tsx"
      to: "src/components/intro/countdown-timer.tsx"
      via: "JSX import and render in hero content block"
      pattern: "CountdownTimer"
---

<objective>
Extend the session data model to support multiple sessions with IDs and Zoom URLs, and add a live countdown timer to the hero section.

Purpose: This is the data foundation that all other Phase 4 plans build on. The countdown timer fulfils INTRO-11 (real countdown to next session) and the extended data model enables session picking (INTRO-12) and confirmation page (INTRO-10).

Output: Extended `intro-talks.ts` with 3 sessions array, new `countdown-timer.tsx` client component, and updated `hero-section.tsx` rendering the timer.
</objective>

<execution_context>
@/Users/mac/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mac/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-registration-flow-session-selection/04-RESEARCH.md
@src/lib/data/intro-talks.ts
@src/components/intro/hero-section.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extend session data model with array, IDs, Zoom URLs, and dateISO</name>
  <files>src/lib/data/intro-talks.ts</files>
  <action>
Replace the entire content of `src/lib/data/intro-talks.ts` with the extended type and sessions array.

The new type must add these fields to `IntroTalkSession`:
- `id: string` — slug format e.g. "2026-03-08-1000"
- `zoomUrl: string` — use "https://zoom.us/j/PLACEHOLDER" with a TODO comment noting real URLs needed
- `dateISO: string` — ISO 8601 UTC e.g. "2026-03-08T10:00:00Z"
- `badge?: string` — optional badge text e.g. "Popular" | "Limited Spots"

Keep existing fields: `title`, `date`, `time`, `timezone`, `location`, `duration`.

Export:
1. `IntroTalkSession` type
2. `introTalkSessions: IntroTalkSession[]` array with exactly 3 sessions:
   - Session 1: id "2026-03-08-1000", Saturday 8 March 2026, 10:00 AM, GMT, badge "Popular"
   - Session 2: id "2026-03-15-1000", Saturday 15 March 2026, 10:00 AM, GMT, badge undefined
   - Session 3: id "2026-03-22-1000", Saturday 22 March 2026, 10:00 AM, GMT, badge "Limited Spots"
3. `nextIntroTalk` (for backward compat): `export const nextIntroTalk = introTalkSessions[0]`

Note: UK moves to BST on 30 March 2026 — these March sessions are all GMT. Use `timezone: "GMT"` for all three. The dateISO values must be UTC: 10:00 AM GMT = 10:00:00Z.

Add a clear TODO comment above the zoomUrl field:
```
// TODO: Replace PLACEHOLDER with real Zoom meeting IDs before go-live
```
  </action>
  <verify>
    <automated>cd "/Users/mac/Documents/Art of Living Landing Page" && npx tsc --noEmit 2>&1 | grep -i "intro-talks" || echo "No type errors in intro-talks"</automated>
    <manual>Confirm file exports `introTalkSessions` array with 3 items, each having id, zoomUrl, dateISO, badge fields</manual>
  </verify>
  <done>
    `intro-talks.ts` exports `IntroTalkSession` type, `introTalkSessions` array (3 sessions), and `nextIntroTalk`. Running `npx tsc --noEmit` shows no errors related to this file. All 3 sessions have id, zoomUrl, dateISO fields populated.
  </done>
</task>

<task type="auto">
  <name>Task 2: Build countdown timer client component</name>
  <files>src/components/intro/countdown-timer.tsx</files>
  <action>
Create `src/components/intro/countdown-timer.tsx` as a `"use client"` component.

Implement exactly as specified in the research Pattern 6. Key requirements:

1. Initialize `timeLeft` state as `null` (not a time value) to avoid SSR hydration mismatch
2. `getNextSession()` filters `introTalkSessions` where `new Date(s.dateISO) > new Date()` and returns the first result or null
3. `calcTimeLeft(targetISO)` computes diff = target - now; if diff <= 0 returns null; otherwise returns `{days, hours, minutes, seconds}`
4. `useEffect` on mount: find next session, start `setInterval(tick, 1000)`, clear on unmount
5. Tick logic: recalculate `calcTimeLeft`; if result is null (session passed), call `getNextSession()` again to auto-advance
6. Display format: `2d 14h 32m 08s` — pad hours/minutes/seconds to 2 digits, days unpadded
7. Fallback when no upcoming session: render `<p className="text-sm text-white/80">Registration open — join the next session</p>`
8. While `timeLeft` is null (pre-hydration): return `null` (renders nothing — avoids flash)

Render layout for active timer:
```
<div className="flex items-center gap-3 text-white/90 font-mono text-sm sm:text-base">
  <span>{days}d</span>
  <span>{pad(hours)}h</span>
  <span>{pad(minutes)}m</span>
  <span className="tabular-nums">{pad(seconds)}s</span>
</div>
```

Wrap in a labeled container that shows "Next session in:" above the timer digits when active:
```
<div className="text-center sm:text-left">
  <p className="text-xs text-white/60 uppercase tracking-wider mb-1">Next session in</p>
  {/* timer digits */}
</div>
```
  </action>
  <verify>
    <automated>cd "/Users/mac/Documents/Art of Living Landing Page" && npx tsc --noEmit 2>&1 | grep -i "countdown" || echo "No type errors in countdown-timer"</automated>
    <manual>Check file exists at src/components/intro/countdown-timer.tsx, has "use client" directive, initializes state as null, uses setInterval in useEffect</manual>
  </verify>
  <done>
    `countdown-timer.tsx` exists, exports `CountdownTimer`, has `"use client"`, initializes `timeLeft` as `null`, uses `setInterval` in `useEffect` with cleanup. TypeScript check passes.
  </done>
</task>

<task type="auto">
  <name>Task 3: Integrate countdown timer into hero section</name>
  <files>src/components/intro/hero-section.tsx</files>
  <action>
Update `src/components/intro/hero-section.tsx` to render the `CountdownTimer` component in the hero content block.

The hero currently shows session date/time using a Clock icon + text. Keep that display (it still shows the formatted date string from `nextIntroTalk`). Add the `CountdownTimer` below it, before the CTA button.

Import `CountdownTimer` from `@/components/intro/countdown-timer`.

Place the timer in a visually contained row. The hero renders "10:00 AM GMT" as static text — the timer adds live urgency below that line. Insert it between the date line and the CTA `<a href="#register">` button:

```tsx
{/* Countdown timer — live urgency below static date */}
<div className="flex justify-center mb-6">
  <CountdownTimer />
</div>
```

The `HeroSection` is a Server Component (no `"use client"` directive). Adding a client component import is fine — Next.js handles the client boundary at the `CountdownTimer` component level. Do NOT add `"use client"` to `hero-section.tsx`.

Run a build check after to confirm no hydration warnings appear in the build output.
  </action>
  <verify>
    <automated>cd "/Users/mac/Documents/Art of Living Landing Page" && npm run build 2>&1 | tail -20</automated>
    <manual>Visit /intro in dev server — confirm countdown timer appears between date line and CTA button in the hero section</manual>
  </verify>
  <done>
    `hero-section.tsx` imports and renders `CountdownTimer` between the date display and CTA button. `npm run build` completes with no errors. Hero section renders in the browser with a live countdown.
  </done>
</task>

</tasks>

<verification>
`npm run build` passes with zero errors and zero warnings about hydration.
`src/lib/data/intro-talks.ts` exports `introTalkSessions` array with 3 sessions, each having `id`, `zoomUrl`, `dateISO` fields.
`countdown-timer.tsx` initializes state as `null` (grep confirms: `useState<TimeLeft>(null)`).
Hero section renders CountdownTimer between date line and CTA.
</verification>

<success_criteria>
- `introTalkSessions` array exported with 3 sessions, each with `id`, `zoomUrl`, `dateISO`, `badge?` fields
- `nextIntroTalk` convenience export preserved for backward compatibility
- `CountdownTimer` component live-counts in format `2d 14h 32m 08s`
- Timer auto-advances when session passes; shows fallback text when no upcoming session
- Zero SSR hydration errors (null init pattern)
- `npm run build` passes clean
</success_criteria>

<output>
After completion, create `.planning/phases/04-registration-flow-session-selection/04-01-SUMMARY.md`
</output>
