---
phase: 07-event-pages
plan: "03"
type: execute
wave: 2
depends_on:
  - "07-01"
files_modified:
  - src/components/events/event-video-section.tsx
  - src/components/events/event-social-proof.tsx
  - src/components/events/event-email-optin.tsx
  - src/components/events/event-footer-cta.tsx
autonomous: true
requirements:
  - EVENT-01
  - EVENT-03

must_haves:
  truths:
    - "Video section only renders when event.videoUrl is defined; uses youtube-nocookie.com iframe, no autoplay"
    - "Social proof section shows credibility logos (CNN, Yale, Harvard, Vogue) AND local testimonial cards"
    - "Email opt-in form renders name + email + unticked GDPR checkbox + privacy policy link; submits via useActionState with subscribeToEventUpdates"
    - "Footer CTA repeats the Register Now CTA with date and location reminder; links externally"
    - "No Brevo API calls in this phase — stub action only (Phase 9 scope)"
  artifacts:
    - path: "src/components/events/event-video-section.tsx"
      provides: "Conditional YouTube embed section"
      exports: ["EventVideoSection"]
    - path: "src/components/events/event-social-proof.tsx"
      provides: "Credibility logos + local testimonials"
      exports: ["EventSocialProof"]
    - path: "src/components/events/event-email-optin.tsx"
      provides: "Email opt-in form with GDPR consent (stub, Phase 9 wired)"
      exports: ["EventEmailOptin"]
    - path: "src/components/events/event-footer-cta.tsx"
      provides: "Closing registration CTA"
      exports: ["EventFooterCta"]
  key_links:
    - from: "event-email-optin.tsx"
      to: "src/actions/event-optin.ts"
      via: "useActionState(subscribeToEventUpdates, initialState)"
      pattern: "subscribeToEventUpdates"
    - from: "event-social-proof.tsx"
      to: "event.testimonials"
      via: "EventTestimonial array mapping"
      pattern: "event\\.testimonials"
---

<objective>
Build the lower half of the event page template: Video, Social Proof, Email Opt-in, and Footer CTA sections.

Purpose: These four sections handle social proof, lead capture, and the final conversion push. The email opt-in is the key Phase 7 deliverable for EVENT-03 — it must render as a complete, functional UI (with stub action) so Phase 9 can wire Brevo without touching JSX.
Output: Four component files in `src/components/events/` — parallel with Plan 02 (no file overlap).
</objective>

<execution_context>
@/Users/mac/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mac/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/07-event-pages/07-CONTEXT.md
@.planning/phases/07-event-pages/07-RESEARCH.md
@.planning/phases/07-event-pages/07-01-SUMMARY.md

# Email form pattern to replicate
@src/components/intro/registration-form.tsx
@src/components/course/footer-cta.tsx
@src/components/intro/media-logos-section.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: EventVideoSection and EventSocialProof</name>
  <files>
    src/components/events/event-video-section.tsx
    src/components/events/event-social-proof.tsx
  </files>
  <action>
**EventVideoSection**
Create `src/components/events/event-social-proof.tsx` — WAIT, do video first.

Create `src/components/events/event-video-section.tsx` as a server component.

Props: `{ videoUrl: string }` (caller already checks for undefined — this component always renders when called)

Layout:
- Section: `bg-black py-16 sm:py-24 px-4 sm:px-6`
- Optional header above iframe: centered, `text-white text-2xl font-semibold mb-8` — "See What a Satsang Evening Looks Like"
- 16:9 responsive iframe container: `relative w-full max-w-4xl mx-auto` with inner div using `paddingBottom: "56.25%"` and `position: "relative"`
- Iframe: `className="absolute inset-0 w-full h-full rounded-2xl"` with:
  - src: the videoUrl prop (expected format: `https://www.youtube-nocookie.com/embed/{VIDEO_ID}`)
  - title: "Event video"
  - allow: "accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
  - allowFullScreen
  - NO autoplay param in the src URL (REQUIREMENTS.md explicitly forbids autoplay)

**EventSocialProof**
Create `src/components/events/event-social-proof.tsx` as a server component.

Props: `{ testimonials?: EventTestimonial[] }` — import EventTestimonial from `@/lib/data/events`

Two sub-sections stacked vertically:

**Sub-section 1: Credibility logos**
Reuse the same styled text logo pattern from `src/components/intro/media-logos-section.tsx`.
Logos to show: CNN, Vogue, Harvard Health, Yale, The Guardian — rendered as styled text spans (no image assets needed — consistent with existing project decision documented in STATE.md: "Styled text logos used for CNN/Yoga Journal/Harvard/WashPost — no brand-licensed image assets available").
Layout: `flex flex-wrap justify-center items-center gap-6 sm:gap-10`
Each logo span: distinct font treatment (CNN: `font-black text-2xl`, Vogue: `font-light text-2xl tracking-widest uppercase`, Harvard Health: `text-sm font-semibold`, Yale: `text-lg font-bold italic`, The Guardian: `font-bold text-lg`) — `text-gray-400 hover:text-gray-600 transition-colors`
Section header above logos: `text-sm text-gray-500 text-center uppercase tracking-widest mb-8` — "As featured in"

**Sub-section 2: Local testimonials**
Conditional: only render if testimonials prop is non-empty.
Section header: `text-2xl sm:text-3xl font-bold text-gray-900 text-center mb-10` — "What Devon Participants Say"
Testimonial cards: grid `grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6` (render up to 3 testimonials)
Each card: shadcn Card with `p-6`
  - Optional highlight (if testimonial.highlight): `text-primary font-semibold italic text-base mb-3` inside quotes
  - Full quote: `text-gray-700 text-sm leading-relaxed mb-4` with opening/closing quotation mark styling
  - Name: `text-xs text-gray-500 font-medium uppercase tracking-wide`

Section bg: `bg-white py-16 sm:py-24 px-4 sm:px-6`
Max container: `max-w-6xl mx-auto`
  </action>
  <verify>
    <automated>cd "/Users/mac/Documents/Art of Living Landing Page" && npx tsc --noEmit 2>&1 | grep -E "event-video|event-social" || echo "Video and social proof pass type check"</automated>
  </verify>
  <done>EventVideoSection renders 16:9 iframe from videoUrl prop with no autoplay; EventSocialProof renders styled text credibility logos and optional testimonial cards; no TypeScript errors</done>
</task>

<task type="auto">
  <name>Task 2: EventEmailOptin and EventFooterCta</name>
  <files>
    src/components/events/event-email-optin.tsx
    src/components/events/event-footer-cta.tsx
  </files>
  <action>
**EventEmailOptin**
Create `src/components/events/event-email-optin.tsx`.

This MUST be a client component: `"use client"` at top (required for useActionState).

Props: `{ event: EventConfig }` — import EventConfig from `@/lib/data/events`

Use `useActionState` from React to wire `subscribeToEventUpdates` from `@/actions/event-optin`:
```typescript
const [state, action, isPending] = useActionState(subscribeToEventUpdates, {
  success: false,
  message: "",
})
```

Layout: Centered section with warm/inviting bg.
Section: `bg-muted/40 py-16 sm:py-24 px-4 sm:px-6`
Inner container: `max-w-xl mx-auto text-center`

Header:
- Eyebrow badge: `bg-primary/10 text-primary text-xs font-semibold uppercase tracking-widest px-3 py-1 rounded-full mb-4` — "Stay in the Loop"
- h2: `text-2xl sm:text-3xl font-bold text-gray-900 mb-2` — "Be the First to Know About Devon Events"
- Subtext: `text-gray-600 mb-8` — "Get updates when new Satsang and Kirtan dates are announced."

Form (`<form action={action}` — server action pattern used across this project):
- Name field: Label + Input with name="name", placeholder="Your name", required
- Email field: Label + Input with name="email" type="email", placeholder="your@email.com", required
- GDPR consent: `<div className="flex items-start gap-3 text-left">` with:
  - Checkbox: `<input type="checkbox" name="consent" id="consent" className="mt-1 h-4 w-4 accent-primary" required />`
  - Label: `<label htmlFor="consent" className="text-sm text-gray-600">` — "I agree to receive event updates from Art of Living Devon/Southwest. See our <a href='/privacy-policy' className='underline hover:text-primary'>privacy policy</a>."
  - Display consent error if `state.errors?.consent` present
- Submit button: shadcn Button full width, disabled when isPending — "Get Event Updates" / "Sending..." text
- Field-level error display below each input: `{state.errors?.name && <p className="text-sm text-red-600 mt-1">{state.errors.name[0]}</p>}`

Success state: When `state.success === true`, replace form with success message:
```tsx
<div className="rounded-xl bg-green-50 border border-green-200 p-6 text-center">
  <p className="text-green-800 font-semibold">{state.message}</p>
</div>
```

Use shadcn Input, Label, Button components. Apply `space-y-4` between form fields.
CRITICAL: Include GDPR consent checkbox, unticked by default, with privacy policy link — matches intro talk registration form pattern exactly. This is a LEGAL requirement per UK GDPR/PECR.

**EventFooterCta**
Create `src/components/events/event-footer-cta.tsx` as a server component.

Props: `{ event: EventConfig }`

Layout: Full-bleed bg-primary section (orange) — matches course page footer CTA pattern from `src/components/course/footer-cta.tsx`.
Section: `bg-primary py-16 sm:py-20 px-4 sm:px-6 text-center`
Inner container: `max-w-2xl mx-auto`

Content:
- h2: `text-3xl sm:text-4xl font-bold text-white mb-4` — "{event.title} — Join Us"
- Date/location line: `text-white/80 text-lg mb-2` — "{event.date} · {event.time} {event.timezone}"
- Location line: `text-white/70 mb-8` — event.location
- Price info: if event.price: `text-white/60 text-sm mb-8` — event.price
- CTA: `<a href={event.registrationUrl} target="_blank" rel="noopener noreferrer">` wrapping shadcn Button with `variant="secondary"` (white button on orange) and `size="lg"` — "Reserve Your Place" text

Use `variant="secondary"` for the button (white on orange — same pattern as Phase 05-04 and 06-homepage FooterCta decisions in STATE.md).
  </action>
  <verify>
    <automated>cd "/Users/mac/Documents/Art of Living Landing Page" && npx tsc --noEmit 2>&1 | grep -E "event-email|event-footer" || echo "Email optin and footer CTA pass type check"</automated>
    <manual>Confirm EventEmailOptin has "use client" directive, GDPR consent checkbox (unticked default), privacy policy link, and field-level error display</manual>
  </verify>
  <done>EventEmailOptin is a client component with useActionState, name+email+GDPR fields, field-level errors, success state replacement; EventFooterCta renders orange bg with white secondary Button as external CTA; no TypeScript errors</done>
</task>

</tasks>

<verification>
Run `cd "/Users/mac/Documents/Art of Living Landing Page" && npx tsc --noEmit` — zero errors across all 4 component files.
Grep for "use client" in event-email-optin.tsx confirms it is a client component.
Grep for "autoplay" in event-video-section.tsx returns no matches (autoplay forbidden per REQUIREMENTS.md).
</verification>

<success_criteria>
- EventVideoSection: responsive 16:9 iframe, youtube-nocookie.com, no autoplay
- EventSocialProof: styled text credibility logos + optional local testimonial cards
- EventEmailOptin: "use client", useActionState wired to stub action, name/email/GDPR fields, success/error states, privacy policy link
- EventFooterCta: bg-primary with variant="secondary" button, external CTA link
- No Brevo API calls anywhere (deferred to Phase 9)
- Zero TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/07-event-pages/07-03-SUMMARY.md`
</output>
